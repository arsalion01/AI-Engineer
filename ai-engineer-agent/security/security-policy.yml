# AI Engineer Agent - Security Policy Configuration
# Comprehensive security policies for production deployment

security_policy:
  version: "1.0"
  last_updated: "2024-08-21"
  environment: "production"
  
  # Authentication and Authorization
  authentication:
    google_oauth:
      enabled: true
      required_domains: []  # Empty means all domains allowed
      session_timeout: 86400  # 24 hours
      refresh_token_rotation: true
      
    jwt:
      algorithm: "RS256"
      expiry: 3600  # 1 hour
      refresh_expiry: 604800  # 7 days
      issuer: "ai-engineer-agent"
      
    password_policy:
      min_length: 12
      require_uppercase: true
      require_lowercase: true
      require_numbers: true
      require_special_chars: true
      max_age_days: 90
      history_count: 5
      
    multi_factor:
      enabled: true
      methods: ["totp", "sms", "email"]
      grace_period_hours: 24
      
  # Rate Limiting
  rate_limiting:
    global:
      requests_per_minute: 1000
      burst_size: 100
      
    per_user:
      requests_per_minute: 100
      burst_size: 20
      
    per_ip:
      requests_per_minute: 60
      burst_size: 10
      
    api_endpoints:
      "/api/auth/*":
        requests_per_minute: 10
        burst_size: 2
        window_minutes: 15
        
      "/api/ai/*":
        requests_per_minute: 30
        burst_size: 5
        window_minutes: 60
        
      "/api/upload/*":
        requests_per_minute: 5
        burst_size: 1
        window_minutes: 5
        
      "/api/workflows/*":
        requests_per_minute: 50
        burst_size: 10
        window_minutes: 60
        
  # Data Protection
  data_protection:
    encryption:
      at_rest:
        algorithm: "AES-256-GCM"
        key_rotation_days: 90
        
      in_transit:
        tls_version: "1.3"
        cipher_suites:
          - "TLS_AES_256_GCM_SHA384"
          - "TLS_CHACHA20_POLY1305_SHA256"
          - "TLS_AES_128_GCM_SHA256"
          
    data_classification:
      public: []
      internal:
        - "user_preferences"
        - "project_metadata"
        - "workflow_templates"
        
      confidential:
        - "user_profile"
        - "project_content"
        - "generated_workflows"
        
      restricted:
        - "authentication_tokens"
        - "api_keys"
        - "encryption_keys"
        - "audit_logs"
        
    retention_policy:
      user_data: 
        active_retention_days: 2555  # 7 years
        inactive_retention_days: 1095  # 3 years
        
      audit_logs:
        retention_days: 2555  # 7 years
        
      analytics_data:
        retention_days: 365  # 1 year
        
      temporary_files:
        retention_hours: 24
        
  # Access Control
  access_control:
    rbac:
      enabled: true
      roles:
        admin:
          description: "Full system access"
          permissions: ["*"]
          
        manager:
          description: "Team and project management"
          permissions:
            - "teams:*"
            - "projects:read"
            - "projects:write"
            - "users:read"
            - "analytics:read"
            
        developer:
          description: "Project and workflow development"
          permissions:
            - "projects:read"
            - "projects:write"
            - "workflows:*"
            - "templates:read"
            
        analyst:
          description: "Read-only analytics access"
          permissions:
            - "projects:read"
            - "analytics:read"
            - "reports:read"
            
        viewer:
          description: "Read-only access"
          permissions:
            - "projects:read"
            - "workflows:read"
            - "templates:read"
            
    team_permissions:
      default_role: "developer"
      max_members: 50
      require_approval: true
      
    api_access:
      require_api_key: true
      key_rotation_days: 30
      scoped_permissions: true
      
  # Network Security
  network_security:
    firewall:
      default_policy: "deny"
      allowed_ports:
        - port: 22
          protocol: "tcp"
          source: "admin_ips"
          description: "SSH access"
          
        - port: 80
          protocol: "tcp"
          source: "any"
          description: "HTTP redirect"
          
        - port: 443
          protocol: "tcp"
          source: "any"
          description: "HTTPS"
          
        - port: 3000
          protocol: "tcp"
          source: "load_balancer"
          description: "Application"
          
        - port: 8080
          protocol: "tcp"
          source: "load_balancer"
          description: "WebSocket"
          
    intrusion_prevention:
      enabled: true
      fail2ban:
        ban_time: 86400  # 24 hours
        find_time: 600   # 10 minutes
        max_retry: 3
        
      rate_limiting:
        enabled: true
        threshold: 100
        window: 60
        
    ddos_protection:
      enabled: true
      threshold_requests_per_second: 1000
      mitigation_strategies:
        - "rate_limiting"
        - "captcha"
        - "temporary_block"
        
  # Application Security
  application_security:
    input_validation:
      enabled: true
      sanitization: true
      max_input_size: 10485760  # 10MB
      allowed_file_types:
        - "application/json"
        - "text/plain"
        - "text/markdown"
        - "application/pdf"
        - "image/png"
        - "image/jpeg"
        
    output_encoding:
      enabled: true
      xss_protection: true
      
    csrf_protection:
      enabled: true
      token_timeout: 3600
      
    sql_injection_protection:
      enabled: true
      prepared_statements: true
      query_logging: true
      
    dependency_scanning:
      enabled: true
      vulnerability_threshold: "medium"
      auto_update: false
      
  # Monitoring and Alerting
  security_monitoring:
    logging:
      level: "info"
      retention_days: 90
      encryption: true
      
    audit_logging:
      enabled: true
      events:
        - "authentication"
        - "authorization"
        - "data_access"
        - "configuration_changes"
        - "privilege_escalation"
        
    alerts:
      email:
        enabled: true
        recipients: ["security@ai-engineer-agent.com"]
        
      slack:
        enabled: true
        webhook_url: "${SECURITY_SLACK_WEBHOOK}"
        
      severity_levels:
        critical:
          immediate_notification: true
          escalation_minutes: 5
          
        high:
          notification_delay_minutes: 1
          escalation_minutes: 15
          
        medium:
          notification_delay_minutes: 5
          escalation_minutes: 60
          
        low:
          notification_delay_minutes: 15
          escalation_minutes: 240
          
    metrics:
      collection_interval: 60
      retention_days: 365
      
  # Incident Response
  incident_response:
    team_contacts:
      - role: "security_lead"
        contact: "security-lead@ai-engineer-agent.com"
        phone: "+1-555-SECURITY"
        
      - role: "system_admin"
        contact: "sysadmin@ai-engineer-agent.com"
        phone: "+1-555-SYSADMIN"
        
      - role: "development_lead"
        contact: "dev-lead@ai-engineer-agent.com"
        phone: "+1-555-DEVLEAD"
        
    procedures:
      security_breach:
        - "isolate_affected_systems"
        - "collect_evidence"
        - "notify_stakeholders"
        - "contain_incident"
        - "eradicate_threat"
        - "recover_systems"
        - "post_incident_review"
        
      data_breach:
        - "assess_scope"
        - "notify_authorities"
        - "notify_affected_users"
        - "secure_systems"
        - "document_incident"
        
    communication_plan:
      internal_notification_minutes: 15
      external_notification_hours: 24
      public_disclosure_days: 30
      
  # Backup and Recovery
  backup_security:
    encryption: true
    verification: true
    retention_policy:
      daily_backups: 30
      weekly_backups: 12
      monthly_backups: 12
      yearly_backups: 7
      
    disaster_recovery:
      rto_hours: 4  # Recovery Time Objective
      rpo_hours: 1  # Recovery Point Objective
      
  # Compliance
  compliance:
    gdpr:
      enabled: true
      data_protection_officer: "dpo@ai-engineer-agent.com"
      consent_management: true
      right_to_deletion: true
      
    ccpa:
      enabled: true
      privacy_rights: true
      
    soc2:
      enabled: true
      type2_audit: true
      
    iso27001:
      enabled: true
      controls_implemented: true
      
  # Third-party Security
  third_party:
    vendor_assessment:
      required: true
      security_questionnaire: true
      penetration_testing: true
      
    api_integrations:
      encryption_required: true
      authentication_required: true
      rate_limiting: true
      
    cloud_services:
      approved_providers:
        - "AWS"
        - "GCP"
        - "Azure"
        
      security_requirements:
        - "encryption_at_rest"
        - "encryption_in_transit"
        - "access_logging"
        - "vulnerability_scanning"
        
  # Security Training
  security_training:
    required_for_all_users: true
    frequency_months: 6
    topics:
      - "password_security"
      - "phishing_awareness"
      - "data_protection"
      - "incident_reporting"
      
    developer_training:
      secure_coding: true
      vulnerability_assessment: true
      frequency_months: 3